import{c as oe,o as se}from"./modal-X6AMKalI.js";import{g as pe,h as te,a as le,b as ae,s as ve}from"./alert-DtKmKZVb.js";const e=(o,r=document)=>r.querySelector(o),ge=(o,r=document)=>[...r.querySelectorAll(o)],v=o=>{o&&(o.hidden=!0,o.style.display="none",o.classList.add("is-hidden"))},ie=o=>{o&&(o.hidden=!1,o.style.display="flex",o.classList.remove("is-hidden"))},E=o=>{o&&(o.hidden=!1,o.style.display="block",o.classList.remove("is-hidden"))},J=o=>!o||o==0?"-":o.toString().replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"."),he=o=>{if(!o)return{};if(typeof o=="object"&&o!==null)return o;if(typeof o!="string")return{};try{const r=o.trim();if(!r||r==="null"||r==="undefined")return{};const l=JSON.parse(r);return l&&typeof l=="object"?l:{}}catch(r){return console.warn("JSON parse failed, returning empty object:",r.message),{}}},q=o=>{const r=["","satu","dua","tiga","empat","lima","enam","tujuh","delapan","sembilan","sepuluh","sebelas"];return o=Math.abs(parseInt(o))||0,o<12?r[o]:o<20?q(o-10)+" belas":o<100?q(Math.floor(o/10))+" puluh "+q(o%10):o<200?"seratus "+q(o-100):o<1e3?q(Math.floor(o/100))+" ratus "+q(o%100):o<2e3?"seribu "+q(o-1e3):o<1e6?q(Math.floor(o/1e3))+" ribu "+q(o%1e3):q(Math.floor(o/1e6))+" juta "+q(o%1e6)},xe=(o,r)=>{if(!o)return"";const l=new Date(o);return l.setDate(l.getDate()+parseInt(r)),l.toISOString().split("T")[0]},ye=o=>{ge('input[data-rupiah="true"]',o).forEach(r=>{const l=r.dataset.terbilangTarget;r.addEventListener("input",()=>{let s=r.value.replace(/\D/g,"");r.value=s?J(s):"";const d=l?e(`[name="${l}"]`,o)||e(`#${l}`,o):null;d&&(d.value=s&&s!="0"?(q(s)+" rupiah").toUpperCase():"")})})},we=()=>{ge(".js-location-autofill").forEach(s=>{s.addEventListener("change",()=>{const d=s.options[s.selectedIndex];if(!d)return;const p=(d.dataset.category||"").toUpperCase(),a=(d.dataset.name||"").trim();let i="";p==="ENABLER"||p==="OPERASI"?i="Jakarta":p==="CABANG"&&(i=a.replace(/^Cabang\s+/i,""));const w=s.closest("form"),g=w?w.querySelector('input[name="work_location"]'):null;g&&i&&(g.value=i)})});const r=e("#createUnitCategoryHidden"),l=e("#createUnitNameHidden");if(r&&l){const s=(r.value||"").toUpperCase(),d=(l.value||"").trim();let p="";s==="ENABLER"||s==="OPERASI"?p="Jakarta":s==="CABANG"&&(p=d.replace(/^Cabang\s+/i,""));const a=e("#createLocation");a&&p&&!a.value&&(a.value=p)}},Z={},ce=(o,r,l,s=0,d={})=>{if(!r||!l||!L||!document.getElementById(o))return;if(Z[o]){try{Z[o].remove()}catch(_){console.error("Error removing map:",_)}delete Z[o]}const a={isRealTime:d.isRealTime??!1,initialZoom:d.initialZoom??19,circleVisible:!0,...d},i=_=>_<=15?"EXCELLENT":_<=50?"GOOD":_<=150?"FAIR":"ACCEPTABLE",w={EXCELLENT:"#10b981",GOOD:"#3b82f6",FAIR:"#f59e0b",ACCEPTABLE:"#8b5cf6"},g={EXCELLENT:"Excellent",GOOD:"Good",FAIR:"Fair",ACCEPTABLE:"Acceptable"},y=L.map(o,{zoomControl:!0,scrollWheelZoom:!0,dragging:!0,zoomAnimation:!0,fadeAnimation:!0,markerZoomAnimation:!0,attributionControl:!1}).setView([r,l],a.initialZoom);L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:20,maxNativeZoom:19,minZoom:10,className:"map-tiles",updateWhenIdle:!0,keepBuffer:2,attribution:""}).addTo(y);const U=_=>{const D=window.innerWidth<=768?.6:1,R=Math.max(.3,Math.min(D,(_-10)/8)),B=Math.round(25*R),H=Math.round(41*R),K=Math.round(41*R),W=Math.round(41*R);return L.icon({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png",iconSize:[B,H],iconAnchor:[Math.round(B/2),H],popupAnchor:[0,-H],shadowSize:[K,W],shadowAnchor:[Math.round(K/3),W]})},C=L.marker([r,l],{icon:U(a.initialZoom),zIndexOffset:3e3,draggable:!1,keyboard:!1,riseOnHover:!0,riseOffset:250,interactive:!0,bubblingMouseEvents:!0}).addTo(y);setTimeout(()=>{const _=C.getElement();_&&(_.style.pointerEvents="auto",_.style.cursor="pointer")},100),window.addEventListener("resize",()=>{C&&y._createDynamicIcon&&C.setIcon(y._createDynamicIcon(y.getZoom()))}),y._marker=C,y._createDynamicIcon=U;let P=null,S=!1,N={lat:r,lng:l,acc:s};const x=_=>{const M=i(_),D=g[M];return`<div style="padding:12px 16px;border-radius:10px;background:linear-gradient(135deg,rgba(255,255,255,0.98) 0%,rgba(248,250,252,0.98) 100%);border:1px solid rgba(0,0,0,0.08);box-shadow:0 8px 20px rgba(0,0,0,0.12),0 2px 6px rgba(0,0,0,0.06);backdrop-filter:blur(12px);min-width:220px;max-width:280px"><div style="text-align:center;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',system-ui,sans-serif"><div style="display:flex;align-items:center;justify-content:center;gap:7px;margin-bottom:8px"><span style="font-size:1.2rem;line-height:1">üìç</span><strong style="color:${w[M]};font-size:0.95rem;font-weight:700;letter-spacing:-0.01em">${D} Signal</strong></div><div style="background:linear-gradient(135deg,rgba(0,0,0,0.04) 0%,rgba(0,0,0,0.02) 100%);padding:8px 12px;border-radius:6px;margin:6px 0"><div style="color:#64748b;font-size:0.7rem;font-weight:600;text-transform:uppercase;letter-spacing:0.05em;margin-bottom:2px">GPS Accuracy</div><span style="color:#1e293b;font-size:1rem;font-weight:700;display:block">¬±${Math.round(_)} meters</span></div><div style="margin-top:10px;padding-top:8px;border-top:1px solid rgba(0,0,0,0.06);display:flex;align-items:center;justify-content:center;gap:5px"><span style="font-size:0.85rem">‚ú®</span><small style="color:#64748b;font-size:0.75rem;font-weight:500">Click marker to zoom in</small></div></div></div>`},A=(_=N.lat,M=N.lng,D=N.acc)=>{const R=y.getZoom();if(P){try{y.removeLayer(P)}catch(W){console.error("Error removing circle:",W)}P=null}if(R<17||!a.circleVisible||D<=0||D>500)return;const B=w[i(D)],H=Math.min(.95,.7+(R-12)*.05),K=D;P=L.circle([_,M],{radius:K,color:B,weight:2.5,opacity:Math.min(.9,H+.05),fill:!0,fillColor:B,fillOpacity:Math.min(.25,.15+(R-12)*.015),interactive:!1,bubblingMouseEvents:!1,className:"geo-accuracy-circle",pane:"overlayPane"}).addTo(y),setTimeout(()=>{const W=P.getElement(),u=y.getPane("overlayPane"),t=y.getPane("markerPane"),n=y.getPane("tooltipPane"),c=y.getPane("popupPane");u&&(u.style.zIndex="2",u.style.pointerEvents="none"),t&&(t.style.zIndex="4",t.style.pointerEvents="auto"),n&&(n.style.zIndex="9999",n.style.pointerEvents="none"),c&&(c.style.zIndex="9998"),W&&(W.style.pointerEvents="none")},50)};y._updatePosition=(_,M,D)=>{N={lat:_,lng:M,acc:D},C.setLatLng([_,M]),C.setTooltipContent(x(D)),a.isRealTime&&y.setView([_,M],y.getZoom(),{animate:!1}),A(_,M,D)},setTimeout(()=>{y.invalidateSize(),A()},80);const b=x(s);C.bindTooltip(b,{permanent:!1,direction:"top",offset:[0,-35],opacity:1,className:"custom-marker-tooltip",sticky:!0}),C.on("click",()=>{if(S)return;S=!0;const _=y.getZoom(),M=Math.max(_,20);M>_&&y.flyTo([N.lat,N.lng],M,{animate:!0,duration:.8,easeLinearity:.25}),setTimeout(()=>{S=!1},850)});let I;return y.on("zoomend",()=>{clearTimeout(I),I=setTimeout(()=>{const _=y.getZoom();y._createDynamicIcon&&C&&C.setIcon(y._createDynamicIcon(_)),A()},50)}),y.on("moveend",()=>{a.isRealTime&&!S&&A()}),Z[o]=y,y},ee=document.querySelector('meta[name="csrf-token"]')?.content,ke=()=>{const o=e("#btnOpenCreate"),r=e("#createContractForm");if(!o||!r)return;ye(r),r.addEventListener("submit",async t=>{t.preventDefault();const n=t.submitter||r.querySelector('[type="submit"]:focus'),c=n?.value==="draft",h=n?.innerHTML||"Submit";try{n&&(n.disabled=!0,n.innerHTML='<i class="fas fa-spinner fa-spin"></i> Menyimpan...');const m=new FormData(r);n&&n.name&&m.append(n.name,n.value),pe("Menyimpan dokumen...");const f=await fetch(r.action,{method:"POST",headers:{"X-CSRF-TOKEN":ee,Accept:"application/json"},body:m}),k=await f.json().catch(()=>({}));if(te(),f.ok&&(k.success??!0))le(c?"Draft berhasil disimpan":"Dokumen berhasil dibuat"),oe("createContractModal"),r.reset(),window.contractsTable&&window.contractsTable.ajax.reload(null,!1);else throw new Error(k.message||"Gagal menyimpan dokumen")}catch(m){te(),ae(m.message||"Terjadi kesalahan saat menyimpan")}finally{n&&(n.disabled=!1,n.innerHTML=h)}});const l=e("#createFamilySelect"),s=e("#createSubtypeSelect"),d=e("#createSourceSelect"),p=e("#filterSourceUnit"),a=e("#createApplicantSelect"),i=e("#createRecruitmentRequestSelect"),w=e("#createTypeInput"),g=e("#createModeInput"),y=e("#createSubtypeWrap"),U=e("#createMainSection"),C=e("#sectionPkwtSpk"),P=e("#sectionPb"),S=e("#sectionRemun"),N=e('[data-mode-section="new"]'),x=e('[data-mode-section="existing"]'),A=e("#prevTicket");let b=null,I=null;const _=async(t=null)=>{if(i)try{const n=i.value,c=new URL(window.contractsBaseUrl+"/api/recruitment-requests",window.location.origin);t&&c.searchParams.set("unit_id",t);const m=await(await fetch(c,{headers:{Accept:"application/json","X-CSRF-TOKEN":ee}})).json();i.innerHTML='<option value="">-- Tanpa Izin Prinsip / Pilih Manual --</option>',m.forEach(f=>{const k=document.createElement("option");k.value=f.id,k.textContent=`${f.ticket_number} - ${f.title} (${f.position_text})`,k.dataset.json=JSON.stringify(f),i.appendChild(k)}),n&&Array.from(i.options).some(f=>f.value===n)&&(i.value=n)}catch(n){console.error("Failed to load recruitment requests:",n)}},M=async t=>{if(!(!a||!t))try{const n=`${window.contractsBaseUrl}/api/recruitment-requests/${t}/applicants`,h=await(await fetch(n,{headers:{Accept:"application/json","X-CSRF-TOKEN":ee}})).json();a.innerHTML='<option value="">-- Pilih Pelamar dari Izin Prinsip --</option>',h.forEach(m=>{const f=document.createElement("option");f.value=m.id,f.dataset.personId=m.person_id||"",f.dataset.fullname=m.name,f.dataset.pos=m.position_name,f.dataset.unit=I?.unit_name||"",f.dataset.unitId=I?.unit_id||"",f.textContent=`${m.name} - ${m.position_name}`,a.appendChild(f)})}catch(n){console.error("Failed to load applicants:",n)}},D=t=>{if(!t)return;const n=e("#createUnitSelectNew");n&&t.unit_id&&(n.value=t.unit_id,n.dispatchEvent(new Event("change")));const c=e('input[name="position_name"]'),h=e("#createPositionIdInput");c&&t.position_text&&(c.value=t.position_text),h&&t.position_id&&(h.value=t.position_id);const m=e("#createEmpType");if(m&&t.employment_type){let T=t.employment_type;T==="Organik"?T="Kontrak Organik":T==="Project Based"&&(T="Kontrak-Project Based"),T!=="Tetap"&&!T.includes("Alih Daya")&&Array.from(m.options).some(V=>V.value===T)&&(m.value=T)}const f=e('input[name="start_date"]'),k=e('input[name="end_date"]');f&&t.start_date&&(f.value=t.start_date),k&&t.end_date&&(k.value=t.end_date);const O=e("#createLocation");O&&t.location&&(O.value=t.location);const F=e('input[name="salary_amount"]');if(F&&t.salary){const T=t.salary.toString().replace(/\D/g,"");F.value=T,F.dispatchEvent(new Event("input"))}const Y=e('input[name="lunch_allowance_daily"]');Y&&t.allowanceL&&(Y.value=t.allowanceL.toString().replace(/\D/g,""),Y.dispatchEvent(new Event("input")));const X=e('input[name="allowance_position_amount"]');X&&t.allowanceP&&(X.value=t.allowanceP.toString().replace(/\D/g,""),X.dispatchEvent(new Event("input")));const Q=e('input[name="allowance_communication_amount"]');Q&&t.allowanceK&&(Q.value=t.allowanceK.toString().replace(/\D/g,""),Q.dispatchEvent(new Event("input")));const G=e('input[name="allowance_special_amount"]');G&&t.allowanceJ&&(G.value=t.allowanceJ.toString().replace(/\D/g,""),G.dispatchEvent(new Event("input")));const j=e('input[name="other_benefits_desc"]');if(j){let T=[];t.bpjs_kes&&T.push(`BPJS Kesehatan: Rp ${J(t.bpjs_kes)}`),t.bpjs_tk&&T.push(`BPJS Ketenagakerjaan: Rp ${J(t.bpjs_tk)}`),t.pph21&&T.push(`PPh21: Rp ${J(t.pph21)}`),t.thr&&T.push(`THR: Rp ${J(t.thr)}`),T.length>0&&(j.value=T.join(" | "))}},R=()=>{const t=e("#prevPosField"),n=e("#prevDateSection"),c=w.value,h=c==="SPK"||c==="PKWT_BARU",m=c==="PKWT_PERPANJANGAN"||c==="PB_PENGAKHIRAN";t&&(t.style.display=h?"none":"block"),n&&(n.style.display=m?"block":"none")},B=(t,n)=>{t&&t.querySelectorAll("input, select, textarea").forEach(c=>c.disabled=!n)},H=()=>{const t=w.value;if(!b)return;const n=xe(b.end,1);if(t==="PB_PENGAKHIRAN"){const f=e("#createPbEnd");f&&(f.value=n)}else if(t==="PKWT_PERPANJANGAN"){const f=e("#createStartDate");f&&(f.value=n)}const c=e("#createPosName"),h=e("#createEmpType"),m=e("#createUnitSelectExisting");c&&(c.value=b.pos||""),h&&b.empType&&(h.value=b.empType),m&&(m.value=b.unitId||"",m.dispatchEvent(new Event("change")))},K=()=>{const n=g.value==="new",c=w.value;if(E(U),n){E(N),v(x),B(N,!0),B(x,!1);const k=e("#createUnitNewWrap");c==="SPK"?v(k):E(k)}else{v(N),E(x),B(N,!1),B(x,!0);const k=e("#labelSourceExisting");k&&(k.textContent=c==="PB_PENGAKHIRAN"?"Pilih Kontrak yang Diakhiri":"Pilih Kontrak Dasar");const O=e("#unitWrapperForExisting");c==="PB_PENGAKHIRAN"?v(O):E(O)}c==="PB_PENGAKHIRAN"?(v(C),v(S),E(P)):(E(C),E(S),v(P));const m=c&&c.includes("PKWT"),f=e("#createLocationSection");f&&(m?E(f):v(f)),H()},W=()=>{try{r.reset(),l&&(l.value=""),s&&(s.value=""),d&&(d.value=""),a&&(a.value=""),i&&(i.value=""),b=null,I=null,v(y),v(U),v(C),v(P),v(S),v(N),v(x);const t=e("#createPersonPreview");t&&v(t),A&&(A.textContent="");const n=e("#prevPhoto"),c=e("#prevPhotoPlaceholder"),h=e("#prevNik");n&&(n.style.display="none"),c&&(c.style.display="flex"),h&&(h.style.display="none"),we()}catch(t){console.error(t)}};o.addEventListener("click",t=>{t.preventDefault(),W(),se("createContractModal");const n=window.currentUserUnit;_(n)}),i&&i.addEventListener("change",async t=>{t.preventDefault(),t.stopPropagation();const n=i.value;if(n)try{const c=`${window.contractsBaseUrl}/api/recruitment-requests/${n}/detail`,m=await(await fetch(c,{headers:{Accept:"application/json","X-CSRF-TOKEN":ee}})).json();I=m,A&&m.ticket_number&&(A.textContent=`Ticket: ${m.ticket_number}`),await M(n)}catch(c){console.error("Failed to load RR:",c)}else I=null,A&&(A.textContent="")});const u=e("#createUnitSelectNew");u&&i&&u.addEventListener("change",()=>{const t=u.value;t&&_(t)}),l&&l.addEventListener("change",()=>{const t=l.value;b=null,v(U),v(y);const n=e("#createPersonPreview");if(n&&v(n),a&&(a.value=""),!!t)if(t==="PKWT")E(y),w.value="",g.value="";else{const c=l.options[l.selectedIndex];w.value=t==="SPK"?"SPK":t==="PB"?"PB_PENGAKHIRAN":"",g.value=c.dataset.mode||"",K(),R()}}),s&&s.addEventListener("change",()=>{const t=s.value,n=e("#createPersonPreview");if(n&&v(n),a&&(a.value=""),d&&(d.value=""),b=null,!t){v(U);return}const c=s.options[s.selectedIndex];w.value=t,g.value=c.dataset.mode,K(),R()}),a&&a.addEventListener("change",async()=>{const t=a.options[a.selectedIndex],n=e("#createPersonIdInput"),c=e("#createEmployeeIdInput");if(a.value){n.value=t.dataset.personId||"",c.value="",I&&D(I);const h=t.dataset.fullname||"-",m=t.dataset.pos||"-",f=I?I.unit_name:t.dataset.unit||"-";e("#prevName").textContent=h,e("#prevPos").textContent=m,e("#prevUnit").textContent=f,R();const k=w.value,O=k==="SPK"||k==="PKWT_BARU",F=e("#prevNik");if(O&&t.dataset.personId)try{const G=await fetch(`${window.contractsBaseUrl}/api/persons/${t.dataset.personId}`,{headers:{Accept:"application/json","X-CSRF-TOKEN":ee}});if(G.ok){const j=await G.json();j.nik&&(F.textContent=`NIK: ${j.nik}`,F.style.display="block");const T=e("#prevPhoto"),V=e("#prevPhotoPlaceholder");j.photo_path&&(T.src=`/storage/${j.photo_path}`,T.style.display="block",V.style.display="none")}}catch(G){console.error("Failed to fetch person data:",G)}const Y=e("#prevDateSection"),X=e("#prevDateLabel"),Q=e("#prevDate");if(k==="PKWT_PERPANJANGAN"||k==="PB_PENGAKHIRAN")b&&b.end&&(X.textContent="Periode Lama",Q.textContent=`Berakhir: ${b.endHuman}`,Y.style.display="block");else if(I&&I.start_date&&I.end_date){const G=new Date(I.start_date).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"}),j=new Date(I.end_date).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"});X.textContent="Periode Kontrak",Q.textContent=`${G} - ${j}`,Y.style.display="block"}E(e("#createPersonPreview"))}else v(e("#createPersonPreview"))}),p&&d&&(p.addEventListener("change",()=>{const t=p.value;[...d.options].forEach(n=>{n.value&&(!t||n.dataset.unitId==t?(n.hidden=!1,n.disabled=!1):(n.hidden=!0,n.disabled=!0))}),d.value="",b=null,v(e("#createPersonPreview"))}),d.addEventListener("change",()=>{const t=d.options[d.selectedIndex],n=e("#createSourceIdInput"),c=e("#createPersonIdInput"),h=e("#createEmployeeIdInput");if(!d.value){b=null,v(e("#createPersonPreview")),n.value="",c.value="",h.value="";return}b={id:d.value,unitId:t.dataset.unitId,unitName:t.dataset.unitName,personId:t.dataset.personId,employeeId:t.dataset.employeeId,person:t.dataset.person,pos:t.dataset.pos,start:t.dataset.start,end:t.dataset.end,endHuman:t.dataset.endHuman,nik:t.dataset.nik,empType:t.dataset.empType},n.value=b.id,c.value=b.personId,h.value=b.employeeId;const m=e("#createUnitSelectExisting");m&&(m.value=b.unitId,m.dispatchEvent(new Event("change"))),e("#prevName").textContent=b.person||"-",e("#prevPos").textContent=b.pos||"-",e("#prevUnit").textContent=b.unitName||"-",e("#prevNik").textContent=b.nik||"-";const f=e("#prevDateSection"),k=e("#prevDateLabel"),O=e("#prevDate");k.textContent="Periode Lama",O.textContent="Berakhir: "+b.endHuman,f.style.display="block",A&&(A.textContent=""),E(e("#createPersonPreview")),R(),H()}))},Pe=()=>{$(document).on("click",".js-btn-edit",async function(r){r.preventDefault();const l=this;se("editContractModal");const d=e("#editContractModal")?.querySelector(".u-modal__body");if(d){d.scrollTop=0,d.scrollLeft=0;const p=document.createElement("div");p.className="modal-loading-overlay",p.innerHTML=`
                <div class="spinner-container">
                    <div class="u-dt-liquid-spinner"><div class="drop"></div><div class="drop"></div><div class="drop"></div></div>
                    <div class="spinner-text">Memuat data kontrak...</div>
                </div>
            `,d.appendChild(p)}try{const p=await fetch(l.dataset.showUrl,{headers:{Accept:"application/json"}}).then(S=>S.json()),a=d?.querySelector(".modal-loading-overlay");if(a&&a.remove(),!p.success)throw new Error(p.message);const i=p.data,w=he(i.remuneration_json),g=e("#editContractForm");ye(g),g.action=l.dataset.updateUrl,e("#editTypeInput").value=i.contract_type,e("#editSourceIdInput").value=i.parent_contract_id||"",e("#editEmployeeId").value=i.employee_id||"",e("#editPersonId").value=i.person_id||"",e("#editApplicantId").value=i.applicant_id||"",e("#editDisplayPerson").textContent=i.person_name,e("#editDisplayType").textContent=i.contract_type_label,e("#editPos").value=i.position_name||"",e("#editRemarks").value=i.remarks||"";const y=i.contract_type.includes("PKWT"),U=e("#editLocationSection");if(U&&(y?(E(U),e("#editLocation").value=w.work_location||""):v(U)),e("#editUnitSelect")?e("#editUnitSelect").value=i.unit_id:e("#editUnitIdHidden")&&(e("#editUnitIdHidden").value=i.unit_id,e("#editUnitDisplay").value=i.unit?.name||""),i.contract_type==="PB_PENGAKHIRAN"){v(e("#editSectionPkwtSpk")),E(e("#editSectionPb")),e("#editPbEnd").value=w.pb_effective_end||"";const S=e("#editPbComp");S.value=J(w.pb_compensation_amount),S.dispatchEvent(new Event("input"))}else{E(e("#editSectionPkwtSpk")),v(e("#editSectionPb")),e("#editStart").value=i.start_date_raw||"",e("#editEnd").value=i.end_date_raw||"";const S=(N,x)=>{const A=e(N);A&&(A.value=J(x),A.dispatchEvent(new Event("input")))};S("#editSalary",w.salary_amount),S("#editLunch",w.lunch_allowance_daily),S("#editAP",w.allowance_position_amount),S("#editAC",w.allowance_communication_amount),S("#editAS",w.allowance_special_amount),S("#editAO",w.allowance_other_amount),S("#editTravelStay",w.travel_allowance_stay||15e4),S("#editTravelNonStay",w.travel_allowance_non_stay||75e3),e("#editOB").value=w.other_benefits_desc||"",e("#editWorkDays").value=w.work_days||"Senin s/d hari Jumat",e("#editWorkHours").value=w.work_hours||"Jam 07.30 WIB s/d 16.30 WIB",e("#editBreakHours").value=w.break_hours||"Jam 12.00 WIB s/d 13.00 WIB"}const P=e("#editNewUnitWrapper");i.contract_type==="PKWT_PERPANJANGAN"?(E(P),w.new_unit_id&&(e("#editNewUnitId").value=w.new_unit_id)):v(P)}catch(p){console.error(p);const a=d?.querySelector(".modal-loading-overlay");a&&a.remove(),oe("editContractModal"),ve({icon:"error",title:"Gagal!",text:p.message||"Gagal memuat data dokumen"})}});const o=e("#editContractForm");o&&o.addEventListener("submit",async r=>{r.preventDefault();const l=r.submitter||o.querySelector('[type="submit"]:focus'),s=l?.value==="draft",d=l?.innerHTML||"Submit";try{l&&(l.disabled=!0,l.innerHTML='<i class="fas fa-spinner fa-spin"></i> Menyimpan...');const p=new FormData(o);l&&l.name&&p.append(l.name,l.value),pe("Menyimpan perubahan...");const a=await fetch(o.action,{method:"POST",headers:{"X-CSRF-TOKEN":ee,Accept:"application/json"},body:p}),i=await a.json().catch(()=>({}));if(te(),a.ok&&(i.success??!0))le(s?"Draft berhasil disimpan":"Dokumen berhasil diperbarui"),oe("editContractModal"),setTimeout(()=>{window.contractsTable&&window.contractsTable.ajax.reload(null,!1)},100);else throw new Error(i.message||"Gagal menyimpan dokumen")}catch(p){te(),ae(p.message||"Terjadi kesalahan saat menyimpan")}finally{l&&(l.disabled=!1,l.innerHTML=d)}})},Ee=()=>{$(document).on("click",".js-btn-detail",async function(o){o.preventDefault();const r=this;se("detailContractModal");const s=e("#detailContractModal")?.querySelector(".u-modal__body");if(s){s.scrollTop=0,s.scrollLeft=0;const d=document.createElement("div");d.className="modal-loading-overlay",d.innerHTML=`
                <div class="spinner-container">
                    <div class="u-dt-liquid-spinner"><div class="drop"></div><div class="drop"></div><div class="drop"></div></div>
                    <div class="spinner-text">Memuat detail kontrak...</div>
                </div>
            `,s.appendChild(d)}try{const d=await fetch(r.dataset.showUrl,{headers:{Accept:"application/json"}}).then(n=>n.json()),p=s?.querySelector(".modal-loading-overlay");if(p&&p.remove(),!d.success)throw new Error(d.message);const a=d.data,i=he(a.remuneration_json),w=a.contract_type==="PB_PENGAKHIRAN",g=(n,c)=>{const h=e(n);h&&(h.textContent=c)};g("#detNo",a.contract_no||"-"),g("#detType",a.contract_type_label||a.contract_type||"-"),g("#detStatus",a.status||"-"),g("#detUnit",a.unit?.name||"-"),g("#detName",a.person_name||"-"),g("#detNik",a.ui_employee_id||"-"),g("#detNikReal",a.ui_nik_ktp||"-"),g("#detPos",a.position_name||"-"),g("#detEmpType",a.employment_type||"-"),g("#detTicket",a.ticket_number||"-");const y=e("#detRejectBox"),U=(a.rejection_note||"").toString().trim();(a.status==="draft"||a.status==="rejected")&&U?y&&(E(y),g("#detRejectNote",U)):v(y);const C=e("#detLocationRow");if(C&&(a.contract_type?.includes("PKWT")?(E(C),g("#detLocation",i.work_location||"-")):v(C)),a.tracker){const n=a.tracker.head,c=a.tracker.candidate;g("#nameHead",n.name),g("#posHead",n.position||"Kepala Unit"),g("#dateHead",n.date);const h=e("#badgeHead");h&&(h.textContent=n.status,h.className=`u-badge ${n.css}`);const m=e("#iconHead");if(m){const O=n.status==="Signed"||n.status==="Approved",F=n.status==="Rejected";m.className=`u-avatar u-avatar--md ${O?"u-bg-success-light u-text-success":F?"u-bg-danger-light u-text-danger":"u-bg-light u-text-muted"}`,m.innerHTML=O?'<i class="fas fa-check"></i>':F?'<i class="fas fa-times"></i>':'<i class="fas fa-user-tie"></i>'}g("#nameCand",c.name),g("#dateCand",c.date),a.target_role_label&&g("#labelCand",a.target_role_label);const f=e("#badgeCand");f&&(f.textContent=c.status,f.className=`u-badge ${c.css}`);const k=e("#iconCand");k&&(k.className=`u-avatar u-avatar--md ${c.status==="Signed"?"u-bg-success-light u-text-success":"u-bg-light u-text-muted"}`,k.innerHTML=c.status==="Signed"?'<i class="fas fa-check"></i>':'<i class="fas fa-user"></i>')}const P=a.geolocation||{},S=e("#detMapSection"),N=e("#wrapperMapHead"),x=e("#wrapperMapCand"),A=e("#img-head"),b=e("#no-img-head"),I=e("#img-cand"),_=e("#no-img-cand");if(A&&(A.style.display="none"),b&&(b.style.display="none"),I&&(I.style.display="none"),_&&(_.style.display="none"),P.head||P.candidate?E(S):v(S),P.head?(E(N),g("#ts-head",`Signed: ${P.head.ts}`),ce("map-head",P.head.lat,P.head.lng,P.head.acc||0,{initialZoom:19,circleVisible:!0}),P.head.image_url?A&&(A.src=P.head.image_url,E(A)):E(b)):v(N),P.candidate?(E(x),g("#ts-cand",`Signed: ${P.candidate.ts}`),ce("map-cand",P.candidate.lat,P.candidate.lng,P.candidate.acc||0,{initialZoom:19,circleVisible:!0}),P.candidate.image_url?I&&(I.src=P.candidate.image_url,E(I)):E(_)):v(x),w)v(e("#detRemunBox")),v(e("#detPeriodRow")),E(e("#detPbBox")),g("#detPbEff",i.pb_effective_end||"-"),g("#detPbVal","Rp "+J(i.pb_compensation_amount)),g("#detPbValW",(i.pb_compensation_amount_words||"").toString());else{E(e("#detRemunBox")),E(e("#detPeriodRow")),v(e("#detPbBox")),g("#detPeriod",`${a.start_date||"-"} s/d ${a.end_date||"-"}`),g("#detSalary","Rp "+J(i.salary_amount)),g("#detLunch","Rp "+J(i.lunch_allowance_daily)),g("#detWorkDays",i.work_days||"-"),g("#detWorkHours",i.work_hours||"-");const n=[];i.allowance_position_amount&&n.push(["Tunjangan Jabatan",i.allowance_position_amount]),i.allowance_communication_amount&&n.push(["Tunjangan Kinerja",i.allowance_communication_amount]),i.allowance_special_amount&&n.push(["Tunjangan Project",i.allowance_special_amount]),i.allowance_other_amount&&n.push(["Tunjangan Lainnya",i.allowance_other_amount]);const c=e("#detAllowances");c&&(c.innerHTML=n.length>0?n.map(h=>`<div class="u-flex u-justify-between u-py-sm u-border-b u-gap-md"><span class="u-text-sm u-muted u-font-medium">${h[0]}</span><strong class="u-text-sm u-font-semibold">Rp ${J(h[1])}</strong></div>`).join(""):'<div class="u-text-sm u-muted u-text-center u-py-md">Tidak ada tunjangan</div>')}const M=e("#detNewUnitBox"),D=(i.prev_unit_id??"").toString(),R=(i.new_unit_id??"").toString();a.contract_type==="PKWT_PERPANJANGAN"&&D&&R&&D!==R?(E(M),g("#detNewUnit",i.new_unit_name||"-")):v(M);const B=e("#btnPreviewDoc");a.doc_url?(ie(B),B.style.display="inline-flex",B.href=a.doc_url):v(B);const H=e("#btnApprove");a.can_approve?(ie(H),H.onclick=()=>window.handleSign(a.approve_url)):v(H);const K=e("#btnSign");a.can_sign?(ie(K),K.onclick=()=>window.handleSign(a.sign_url)):v(K);const W=e("#btnReject");a.can_approve&&a.reject_url?(ie(W),W.onclick=()=>window.openReject(a.reject_url,`${a.contract_no||"-"} ‚Ä¢ ${a.person_name||"-"}`)):v(W);const u=e("#detLogSection"),t=e("#detLogList");if(a.can_see_logs&&a.approval_logs){E(u);const n=a.approval_logs.map(h=>{let m='<i class="fas fa-check"></i>',f="u-bg-success-light",k="u-text-success";return h.status==="rejected"?(m='<i class="fas fa-times"></i>',f="u-bg-danger-light",k="u-text-danger"):h.status==="pending"&&(m='<i class="fas fa-clock"></i>',f="u-bg-light",k="u-text-muted"),`<div class="u-flex u-gap-md u-mb-md u-items-start">
                        <div class="u-avatar u-avatar--sm ${k}" style="background: var(--surface-2); border: 1px solid var(--border-color); flex-shrink: 0;">${m}</div>
                        <div class="u-flex-1" style="min-width: 0;">
                            <div class="u-flex u-justify-between u-items-start u-w-full">
                                <div class="u-pr-sm"><div class="u-font-semibold u-text-sm">${h.name}</div><div class="u-text-xs u-muted">${h.role}</div></div>
                                <div class="u-text-xs u-muted u-flex-shrink-0" style="margin-left: auto !important; white-space: nowrap; text-align: right;">${h.time_ago}</div>
                            </div>
                            <div class="u-text-sm u-p-sm u-rounded ${f} ${k} u-mt-xs"><strong>${h.status.toUpperCase()}</strong>${h.note?": "+h.note:""}<div class="u-text-xs u-mt-xxs u-muted">${h.date_formatted}</div></div>
                        </div>
                    </div>`}).join(""),c=`<div class="u-flex u-gap-md u-mb-md u-items-start">
                    <div class="u-avatar u-avatar--sm u-text-brand" style="background: var(--surface-2); border: 1px solid var(--border-color); flex-shrink: 0;"><i class="fas fa-plus"></i></div>
                    <div class="u-flex-1" style="min-width: 0;">
                        <div class="u-flex u-justify-between u-items-start u-w-full">
                            <div class="u-pr-sm"><div class="u-font-semibold u-text-sm">${a.creator_name||"System"}</div><div class="u-text-xs u-muted">Document Created</div></div>
                            <div class="u-text-xs u-muted u-flex-shrink-0" style="margin-left: auto !important; white-space: nowrap; text-align: right;">${a.created_at_human||""}</div>
                        </div>
                        <div class="u-text-sm u-p-sm u-rounded u-bg-light u-text-muted u-mt-xs"><strong>CREATED</strong><div class="u-text-xs u-mt-xxs u-muted">${a.created_at_formatted||""}</div></div>
                    </div>
                </div>`;t.innerHTML=n+c}else v(u);setTimeout(()=>{["map-head","map-cand"].forEach(n=>{if(Z[n]&&typeof Z[n].invalidateSize=="function")try{Z[n].invalidateSize(!0)}catch(c){console.error("Map invalidate error:",c)}})},250)}catch(d){console.error(d);const p=s?.querySelector(".modal-loading-overlay");p&&p.remove(),oe("detailContractModal"),ve({icon:"error",title:"Gagal!",text:d.message||"Gagal memuat data dokumen"})}})},Se=()=>{let o={url:"",meta:""};window.openReject=(l,s)=>{o.url=l||"",o.meta=s||"";const d=e("#rejectMeta"),p=e("#rejectNote"),a=e("#btnSubmitReject");d&&(d.textContent=o.meta||"-"),p&&(p.value=""),a&&(a.disabled=!1,a.textContent="Tolak Dokumen"),se("rejectModal"),setTimeout(()=>{p&&p.focus()},80)};const r=e("#rejectForm");r&&r.addEventListener("submit",async l=>{l.preventDefault();const s=e("#rejectNote"),d=e("#btnSubmitReject"),p=(s?.value||"").trim();if(!o.url){ae("URL tidak ditemukan","Gagal");return}if(p.length<5){ae("Alasan penolakan wajib diisi minimal 5 karakter","Validasi Gagal"),s?.focus();return}d.disabled=!0,pe("Memproses reject...");try{const a=await fetch(o.url,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":ee,Accept:"application/json"},body:JSON.stringify({rejection_note:p})}),i=await a.json().catch(()=>({}));if(te(),a.ok&&(i.success??!0))le("Dokumen berhasil ditolak"),oe("rejectModal"),oe("detailContractModal"),setTimeout(()=>{window.contractsTable&&window.contractsTable.ajax.reload(null,!1)},100),setTimeout(()=>{document.body.style.overflow="",document.body.classList.remove("overflow-hidden","modal-open")},350);else throw new Error(i.message||"Gagal menolak dokumen")}catch(a){te(),ae(a.message||"Terjadi kesalahan saat menolak dokumen"),d.disabled=!1}})},Te=()=>{window.handleSign=o=>{const r=e("#signModal"),l=e("#signForm"),s=e("#signCanvas"),d=e("#cameraStream"),p=e("#cameraSection"),a=e("#btnSubmitSign");e("#geoStatus");const i=e("#btnCapture"),w=e("#btnRetake"),g=e("#snapshotPreview"),y=e("#map-sign");let U=!1,C=null,P=!1,S=!1,N=null;const x={mouseup:null,touchend:null,scroll:null,resize:null};l.reset(),e('[name="signature_image"]').value="",e('[name="geo_lat"]').value="",e('[name="geo_lng"]').value="",e('[name="snapshot_image"]').value="",U=!1,g.style.display="none",d.style.display="block",v(w),i&&(E(i),i.disabled=!1),y&&(y.style.display="none",y.innerHTML=""),a.disabled=!0,se("signModal"),setTimeout(()=>{s.width=s.offsetWidth,s.height=200;const u=s.getContext("2d");u.lineWidth=2,u.lineCap="round",u.strokeStyle="#000",u.clearRect(0,0,s.width,s.height)},150),(()=>{const u=e("#geoStatus"),t=e("#geoProgress"),n=e("#geoIcon"),c=e("#map-sign-wrapper"),h=e("#map-sign"),m=e("#btnForceLoc");let f=null,k=!1,O=!1,F=[];if(m&&v(m),e('[name="geo_lat"]').value="",!window.isSecureContext&&location.hostname!=="localhost"){u.innerHTML='<span class="u-text-danger">HTTPS required</span>';return}u.innerHTML='<span class="u-text-info"><i class="fas fa-spinner fa-spin"></i> Ultra fast acquiring...</span>',n.className="fas fa-satellite-dish u-text-info",c&&(c.style.display="block"),h&&(h.style.display="block");const Y=(j,T=!1)=>{if(!j?.coords||j.coords.latitude===0||j.coords.longitude===0)return;const{latitude:V,longitude:re,accuracy:z}=j.coords;e('[name="geo_lat"]').value=V,e('[name="geo_lng"]').value=re,e('[name="geo_accuracy"]').value=z;const be={10:[100,"high"],25:[90,"high"],50:[75,"med"],100:[50,"low"],200:[30,"low"]};let[me,fe]=[15,"low"];for(const[ne,[de,ue]]of Object.entries(be))if(z<=ne){[me,fe]=[de,ue];break}if(t.style.width=`${me}%`,t.className=`geo-precision-fill ${fe}`,k){Z["map-sign"]?._updatePosition&&Z["map-sign"]._updatePosition(V,re,z);const ne=T?"üìç":"‚ö°";u.innerHTML=`<span class="${z<=150?"u-text-success":"u-text-warning"}">${ne} ${z<=50?"Precision":"Tracking"} ¬±${Math.round(z)}m${T?"":" ‚Ä¢ Improving..."}</span>`,n.className=`fas fa-location-dot ${z<=150?"u-text-success":"u-text-warning"}`}else{k=!0,O=!0;const ne=[[10,"üéØ Excellent"],[25,"‚úÖ High"],[50,"üëç Good"],[100,"‚ö†Ô∏è Fair"],[300,"‚ö†Ô∏è Low"],["‚ö†Ô∏è Very Low"]],de=(ne.find(([_e])=>z<=_e)||ne[5])[1],ue=T?"üìç":"‚ö°";u.innerHTML=`<span class="${z<=150?"u-text-success":"u-text-warning"}">${ue} ${de} ¬±${Math.round(z)}m${T?"":" ‚Ä¢ Refining..."}</span>`,n.className=`fas fa-location-dot ${z<=150?"u-text-success":"u-text-warning"}`,ce("map-sign",V,re,z,{isRealTime:!0,initialZoom:z<=50?19:z<=150?17:15}),m&&v(m),R()}},X=(j,T=!1)=>{const V=j.coords.accuracy;F.push({lat:j.coords.latitude,lon:j.coords.longitude,acc:V,ts:Date.now()}),F.length>3&&F.shift(),Y(j,T)},Q=j=>{const T={1:"Access denied",2:"GPS unavailable",3:"Timeout"};O||(u.innerHTML=`<span class="u-text-danger">‚ö†Ô∏è ${T[j.code]||"Location error"}</span>`,t.className="geo-precision-fill low",t.style.width="0%",n.className="fas fa-exclamation-circle u-text-danger",m&&ie(m))},G={enableHighAccuracy:!0,timeout:2e4,maximumAge:0};N=navigator.geolocation.watchPosition(j=>X(j,!0),Q,G),setTimeout(()=>{const j={enableHighAccuracy:!1,timeout:8e3,maximumAge:5e3};f=navigator.geolocation.watchPosition(T=>X(T,!1),T=>console.log("Quick:",T.message),j)},100),setTimeout(()=>{f&&navigator.geolocation.clearWatch(f)},1e4)})(),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&(window.isSecureContext||location.hostname==="localhost")?(E(p),e("#cameraPlaceholder").hidden=!1,navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}).then(u=>{C=u,d.srcObject=u,e("#cameraPlaceholder").hidden=!0}).catch(()=>{e("#cameraPlaceholder").textContent="Izin Kamera Ditolak / Tidak Ada"})):v(p),i&&(i.onclick=()=>{if(d.videoWidth>0){const u=document.createElement("canvas");u.width=640,u.height=480,u.getContext("2d").drawImage(d,0,0,u.width,u.height);const t=u.toDataURL("image/jpeg",.8);e('[name="snapshot_image"]').value=t,g.src=t,d.style.display="none",g.style.display="block",v(i),E(w),U=!0,R()}}),w&&(w.onclick=()=>{e('[name="snapshot_image"]').value="",g.style.display="none",d.style.display="block",E(i),v(w),U=!1,R()});const b=s.getContext("2d");let I=s.getBoundingClientRect();const _=()=>{I=s.getBoundingClientRect()};x.scroll=_,x.resize=_,window.addEventListener("scroll",_),window.addEventListener("resize",_);const M=u=>{const t=u.touches?u.touches[0].clientX:u.clientX,n=u.touches?u.touches[0].clientY:u.clientY;return I=s.getBoundingClientRect(),{x:t-I.left,y:n-I.top}},D=u=>{if(!S)return;u.preventDefault();const t=M(u);b.lineTo(t.x,t.y),b.stroke()};s.onmousedown=u=>{S=!0,b.beginPath();const t=M(u);b.moveTo(t.x,t.y)},s.onmousemove=D,s.ontouchstart=u=>{S=!0,b.beginPath();const t=M(u);b.moveTo(t.x,t.y)},s.ontouchmove=D,x.mouseup=()=>{S&&(S=!1,P=!0,R())},x.touchend=()=>{S&&(S=!1,P=!0,R())},window.addEventListener("mouseup",x.mouseup),window.addEventListener("touchend",x.touchend),e("#clearSign").onclick=()=>{b.clearRect(0,0,s.width,s.height),P=!1,a.disabled=!0};const R=()=>{const u=e('[name="geo_lat"]').value!=="",t=p.classList.contains("is-hidden")?!0:U;a.disabled=!(u&&P&&t)};let B=!1;l.onsubmit=async u=>{if(u.preventDefault(),u.stopImmediatePropagation(),B)return console.warn("[SIGN] Submit already in progress, blocked"),!1;B=!0,l.style.pointerEvents="none",a.disabled=!0,a.innerHTML='<i class="fas fa-spinner fa-spin"></i> Menyimpan...',e('[name="signature_image"]').value=s.toDataURL("image/png");const t=new FormData(l);C&&C.getTracks().forEach(n=>n.stop());try{const n=await fetch(o,{method:"POST",headers:{"X-CSRF-TOKEN":ee,Accept:"application/json"},body:t}),c=await n.json().catch(()=>({}));if(n.ok&&(c.success??!0))C&&(C.getTracks().forEach(h=>h.stop()),C=null),window.navigator.geolocation&&N&&(window.navigator.geolocation.clearWatch(N),N=null),x.scroll&&window.removeEventListener("scroll",x.scroll),x.resize&&window.removeEventListener("resize",x.resize),x.mouseup&&window.removeEventListener("mouseup",x.mouseup),x.touchend&&window.removeEventListener("touchend",x.touchend),te(),le("Dokumen berhasil ditandatangani").then(()=>{window.location.reload()});else throw new Error(c.message||"Gagal memproses tanda tangan")}catch(n){te(),ae(n.message||"Terjadi kesalahan saat memproses tanda tangan"),B=!1,a.disabled=!1,a.innerHTML="Simpan & Tanda Tangan",l.style.pointerEvents=""}};let H=!1;const K=()=>{H||(H=!0,C&&(C.getTracks().forEach(u=>u.stop()),C=null),window.navigator.geolocation&&N&&(window.navigator.geolocation.clearWatch(N),N=null),x.scroll&&window.removeEventListener("scroll",x.scroll),x.resize&&window.removeEventListener("resize",x.resize),x.mouseup&&window.removeEventListener("mouseup",x.mouseup),x.touchend&&window.removeEventListener("touchend",x.touchend))};r.querySelectorAll(".js-close-modal").forEach(u=>{const t=u._signCleanup;t&&u.removeEventListener("click",t),u._signCleanup=K,u.addEventListener("click",K,{once:!0})})}};window.initMap=ce;window.maps=Z;document.addEventListener("DOMContentLoaded",()=>{delete L.Icon.Default.prototype._getIconUrl,L.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});const o=window.initDataTables("#contracts-table",{ajax:{url:window.contractsIndexUrl,data:function(r){r.unit_id=document.getElementById("filterUnit")?.value,r.status=document.getElementById("filterStatus")?.value}},order:[[5,"desc"]],columns:[{data:0,orderable:!0},{data:1,orderable:!0},{data:2,orderable:!1},{data:3,orderable:!0},{data:4,orderable:!0},{data:5,orderable:!0},{data:6,orderable:!1,className:"text-center"}],drawCallback:function(){const r=$(this.api().table().container());r.find(".dataTables_length select").addClass("u-input u-input--sm"),r.find(".dataTables_filter input").addClass("u-input u-input--sm");const l=r.find(".dataTables_paginate .paginate_button");l.addClass("u-btn u-btn--sm u-btn--ghost"),l.filter(".current").removeClass("u-btn--ghost").addClass("u-btn--brand"),l.filter(".disabled").addClass("u-disabled").css("opacity","0.5")}});window.contractsTable=o,$("#filterUnit, #filterStatus").on("change",()=>o.draw()),window.triggerEdit=function(r){const l=JSON.parse(decodeURIComponent(r)),s=document.createElement("button");s.dataset.showUrl=`${window.contractsBaseUrl}/${l.id}`,s.dataset.updateUrl=`${window.contractsBaseUrl}/${l.id}`,s.classList.add("js-btn-edit"),document.body.appendChild(s),s.click(),document.body.removeChild(s)},window.triggerDetail=function(r){const l=JSON.parse(decodeURIComponent(r)),s=document.createElement("button");s.dataset.showUrl=`${window.contractsBaseUrl}/${l.id}`,s.classList.add("js-btn-detail"),document.body.appendChild(s),s.click(),document.body.removeChild(s)},we(),ke(),Pe(),Ee(),Se(),Te(),$(document).on("click",".js-btn-delete",async function(r){r.preventDefault();const l=this,s=e('meta[name="csrf-token"]')?.content;if(await window.showDeleteConfirm("dokumen ini")){const p=document.createElement("form");p.method="POST",p.action=l.dataset.url;const a=document.createElement("input");a.type="hidden",a.name="_token",a.value=s,p.appendChild(a);const i=document.createElement("input");i.type="hidden",i.name="_method",i.value="DELETE",p.appendChild(i),document.body.appendChild(p),p.submit()}})});
